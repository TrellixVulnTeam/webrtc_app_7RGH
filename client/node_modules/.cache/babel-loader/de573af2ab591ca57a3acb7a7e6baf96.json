{"ast":null,"code":"var _jsxFileName = \"/home/abu/Documents/dev/experiments/exp1/client/src/components/home/Stream.js\";\nimport Axios from \"axios\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport \"./Home.scss\";\nimport UserContext from \"../../context/UserContext\";\nimport { Link } from \"react-router-dom\";\nimport domain from \"../../util/domain\";\nimport Janus from './Janus';\nimport $ from 'jquery'; // function Stream() {\n//     const { user } = useContext(UserContext);\n//     return (\n//         <div className=\"home\">\n//             {(user && (\n//                 <div className=\"no-user-message\">\n//                     <h2>Here is the stream</h2>\n//                 </div>\n//             ))}\n//         </div>\n//     );\n// }\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Stream() {\n  var server = null;\n  if (window.location.protocol === 'http:') server = \"http://\" + window.location.hostname + \":8088/janus\";else server = \"https://\" + window.location.hostname + \":8089/janus\";\n  var janus = null;\n  var streaming = null;\n  var opaqueId = \"streamingtest-\" + Janus.randomString(12);\n  var bitrateTimer = null;\n  var spinner = null; // var simulcastStarted = false, svcStarted = false;\n\n  var selectedStream = null;\n  $(document).ready(function () {\n    // Initialize the library (all console debuggers enabled)\n    Janus.init({\n      debug: \"all\",\n      callback: function () {\n        // Use a button to start the demo\n        $('#start').one('click', function () {\n          $(this).attr('disabled', true).unbind('click'); // Make sure the browser supports WebRTC\n\n          if (!Janus.isWebrtcSupported()) {\n            bootbox.alert(\"No WebRTC support... \");\n            return;\n          } // Create session\n\n\n          janus = new Janus({\n            server: server,\n            success: function () {\n              // Attach to Streaming plugin\n              janus.attach({\n                plugin: \"janus.plugin.streaming\",\n                opaqueId: opaqueId,\n                success: function (pluginHandle) {\n                  $('#details').remove();\n                  streaming = pluginHandle;\n                  Janus.log(\"Plugin attached! (\" + streaming.getPlugin() + \", id=\" + streaming.getId() + \")\"); // Setup streaming session\n\n                  $('#update-streams').click(updateStreamsList);\n                  updateStreamsList();\n                  $('#start').removeAttr('disabled').html(\"Stop\").click(function () {\n                    $(this).attr('disabled', true);\n                    clearInterval(bitrateTimer);\n                    janus.destroy();\n                    $('#streamslist').attr('disabled', true);\n                    $('#watch').attr('disabled', true).unbind('click');\n                    $('#start').attr('disabled', true).html(\"Bye\").unbind('click');\n                  });\n                },\n                error: function (error) {\n                  Janus.error(\"  -- Error attaching plugin... \", error);\n                  bootbox.alert(\"Error attaching plugin... \" + error);\n                },\n                iceState: function (state) {\n                  Janus.log(\"ICE state changed to \" + state);\n                },\n                webrtcState: function (on) {\n                  Janus.log(\"Janus says our WebRTC PeerConnection is \" + (on ? \"up\" : \"down\") + \" now\");\n                },\n                onmessage: function (msg, jsep) {\n                  Janus.debug(\" ::: Got a message :::\", msg);\n                  var result = msg[\"result\"];\n\n                  if (result) {\n                    if (result[\"status\"]) {\n                      var status = result[\"status\"];\n                      if (status === 'starting') $('#status').removeClass('hide').text(\"Starting, please wait...\").show();else if (status === 'started') $('#status').removeClass('hide').text(\"Started\").show();else if (status === 'stopped') stopStream();\n                    } else if (msg[\"streaming\"] === \"event\") {\n                      // Is simulcast in place?\n                      var substream = result[\"substream\"];\n                      var temporal = result[\"temporal\"];\n\n                      if (substream !== null && substream !== undefined || temporal !== null && temporal !== undefined) {\n                        if (!simulcastStarted) {\n                          simulcastStarted = true;\n                          addSimulcastButtons(remoteFeed.videoCodec === \"vp8\");\n                        } // We just received notice that there's been a switch, update the buttons\n\n\n                        updateSimulcastButtons(substream, temporal);\n                      } // Is VP9/SVC in place?\n\n\n                      var spatial = result[\"spatial_layer\"];\n                      temporal = result[\"temporal_layer\"];\n\n                      if (spatial !== null && spatial !== undefined || temporal !== null && temporal !== undefined) {\n                        if (!svcStarted) {\n                          svcStarted = true;\n                          addSvcButtons();\n                        } // We just received notice that there's been a switch, update the buttons\n\n\n                        updateSvcButtons(spatial, temporal);\n                      }\n                    }\n                  } else if (msg[\"error\"]) {\n                    bootbox.alert(msg[\"error\"]);\n                    stopStream();\n                    return;\n                  }\n\n                  if (jsep) {\n                    Janus.debug(\"Handling SDP as well...\", jsep);\n                    var stereo = jsep.sdp.indexOf(\"stereo=1\") !== -1; // Offer from the plugin, let's answer\n\n                    streaming.createAnswer({\n                      jsep: jsep,\n                      // We want recvonly audio/video and, if negotiated, datachannels\n                      media: {\n                        audioSend: false,\n                        videoSend: false,\n                        data: true\n                      },\n                      customizeSdp: function (jsep) {\n                        if (stereo && jsep.sdp.indexOf(\"stereo=1\") == -1) {\n                          // Make sure that our offer contains stereo too\n                          jsep.sdp = jsep.sdp.replace(\"useinbandfec=1\", \"useinbandfec=1;stereo=1\");\n                        }\n                      },\n                      success: function (jsep) {\n                        Janus.debug(\"Got SDP!\", jsep);\n                        var body = {\n                          request: \"start\"\n                        };\n                        streaming.send({\n                          message: body,\n                          jsep: jsep\n                        });\n                        $('#watch').html(\"Stop\").removeAttr('disabled').click(stopStream);\n                      },\n                      error: function (error) {\n                        Janus.error(\"WebRTC error:\", error);\n                        bootbox.alert(\"WebRTC error... \" + error.message);\n                      }\n                    });\n                  }\n                },\n                onremotestream: function (stream) {\n                  Janus.debug(\" ::: Got a remote stream :::\", stream);\n                  var addButtons = false;\n\n                  if ($('#remotevideo').length === 0) {\n                    addButtons = true;\n                    $('#stream').append('<video class=\"rounded centered hide\" id=\"remotevideo\" width=\"100%\" height=\"100%\" playsinline/>');\n                    $('#remotevideo').get(0).volume = 0; // Show the stream and hide the spinner when we get a playing event\n\n                    $(\"#remotevideo\").bind(\"playing\", function () {\n                      $('#waitingvideo').remove();\n                      if (this.videoWidth) $('#remotevideo').removeClass('hide').show();\n                      if (spinner) spinner.stop();\n                      spinner = null;\n                      var videoTracks = stream.getVideoTracks();\n                      if (!videoTracks || videoTracks.length === 0) return;\n                      var width = this.videoWidth;\n                      var height = this.videoHeight;\n                      $('#curres').removeClass('hide').text(width + 'x' + height).show();\n\n                      if (Janus.webRTCAdapter.browserDetails.browser === \"firefox\") {\n                        // Firefox Stable has a bug: width and height are not immediately available after a playing\n                        setTimeout(function () {\n                          var width = $(\"#remotevideo\").get(0).videoWidth;\n                          var height = $(\"#remotevideo\").get(0).videoHeight;\n                          $('#curres').removeClass('hide').text(width + 'x' + height).show();\n                        }, 2000);\n                      }\n                    });\n                  }\n\n                  Janus.attachMediaStream($('#remotevideo').get(0), stream);\n                  $(\"#remotevideo\").get(0).play();\n                  $(\"#remotevideo\").get(0).volume = 1;\n                  var videoTracks = stream.getVideoTracks();\n\n                  if (!videoTracks || videoTracks.length === 0) {\n                    // No remote video\n                    $('#remotevideo').hide();\n\n                    if ($('#stream .no-video-container').length === 0) {\n                      $('#stream').append('<div class=\"no-video-container\">' + '<i class=\"fa fa-video-camera fa-5 no-video-icon\"></i>' + '<span class=\"no-video-text\">No remote video available</span>' + '</div>');\n                    }\n                  } else {\n                    $('#stream .no-video-container').remove();\n                    $('#remotevideo').removeClass('hide').show();\n                  }\n\n                  if (!addButtons) return;\n\n                  if (videoTracks && videoTracks.length && (Janus.webRTCAdapter.browserDetails.browser === \"chrome\" || Janus.webRTCAdapter.browserDetails.browser === \"firefox\" || Janus.webRTCAdapter.browserDetails.browser === \"safari\")) {\n                    $('#curbitrate').removeClass('hide').show();\n                    bitrateTimer = setInterval(function () {\n                      // Display updated bitrate, if supported\n                      var bitrate = streaming.getBitrate();\n                      $('#curbitrate').text(bitrate); // Check if the resolution changed too\n\n                      var width = $(\"#remotevideo\").get(0).videoWidth;\n                      var height = $(\"#remotevideo\").get(0).videoHeight;\n                      if (width > 0 && height > 0) $('#curres').removeClass('hide').text(width + 'x' + height).show();\n                    }, 1000);\n                  }\n                },\n                ondataopen: function (data) {\n                  Janus.log(\"The DataChannel is available!\");\n                  $('#waitingvideo').remove();\n                  $('#stream').append('<input class=\"form-control\" type=\"text\" id=\"datarecv\" disabled></input>');\n                  if (spinner) spinner.stop();\n                  spinner = null;\n                },\n                ondata: function (data) {\n                  Janus.debug(\"We got data from the DataChannel!\", data);\n                  $('#datarecv').val(data);\n                },\n                oncleanup: function () {\n                  Janus.log(\" ::: Got a cleanup notification :::\");\n                  $('#waitingvideo').remove();\n                  $('#remotevideo').remove();\n                  $('#datarecv').remove();\n                  $('.no-video-container').remove();\n                  $('#bitrate').attr('disabled', true);\n                  $('#bitrateset').html('Bandwidth<span class=\"caret\"></span>');\n                  $('#curbitrate').hide();\n                  if (bitrateTimer) clearInterval(bitrateTimer);\n                  bitrateTimer = null;\n                  $('#curres').hide();\n                  $('#simulcast').remove();\n                  $('#metadata').empty();\n                  $('#info').addClass('hide').hide();\n                  simulcastStarted = false;\n                }\n              });\n            },\n            error: function (error) {\n              Janus.error(error);\n              bootbox.alert(error, function () {\n                window.location.reload();\n              });\n            },\n            destroyed: function () {\n              window.location.reload();\n            }\n          });\n        });\n      }\n    });\n  });\n\n  async function updateStreamsList() {\n    Janus.debug(\"updateStreamsList\");\n    const myInit = {\n      method: 'GET'\n    }; // fetch api \n    //const id = '60c07f7c360386d21c4ba0eb'; // fetch id\n\n    const id = '60d44ebac53d31346858c759';\n    const device = await fetch(`http://localhost:5003/auth/users/${id}/device`, myInit).then(response => response.json()).then(data => data.device);\n    Janus.log(\"fetched device \", device);\n    $('#update-streams').unbind('click').addClass('fa-spin');\n    var body = {\n      request: \"list\"\n    };\n    Janus.debug(\"Sending message:\", body);\n    streaming.send({\n      message: body,\n      success: function (result) {\n        setTimeout(function () {\n          $('#update-streams').removeClass('fa-spin').click(updateStreamsList);\n        }, 500);\n\n        if (!result) {\n          bootbox.alert(\"Got no response to our query for available streams\");\n          return;\n        }\n\n        if (result[\"list\"]) {\n          $('#streams').removeClass('hide').show();\n          $('#streamslist').empty();\n          $('#watch').attr('disabled', true).unbind('click');\n          var list = result[\"list\"];\n          Janus.log(\"Got a list of available streams\");\n\n          if (list && Array.isArray(list)) {\n            list.sort(function (a, b) {\n              if (!a || a.id < (b ? b.id : 0)) return -1;\n              if (!b || b.id < (a ? a.id : 0)) return 1;\n              return 0;\n            });\n          }\n\n          Janus.debug(list);\n          list = list.filter(stream => device.includes(stream.id + \"\"));\n          Janus.log(\"filtered list : \", list);\n\n          for (var mp in list) {\n            Janus.debug(\"  >> [\" + list[mp][\"id\"] + \"] \" + list[mp][\"description\"] + \" (\" + list[mp][\"type\"] + \")\");\n            $('#streamslist').append(\"<li><a href='#' id='\" + list[mp][\"id\"] + \"'>\" + list[mp][\"description\"] + \" (\" + list[mp][\"type\"] + \")\" + \"</a></li>\");\n          }\n\n          $('#streamslist a').unbind('click').click(function () {\n            selectedStream = $(this).attr(\"id\");\n            $('#streamset').html($(this).html()).parent().removeClass('open');\n            return false;\n          });\n          $('#watch').removeAttr('disabled').unbind('click').click(startStream);\n        }\n      }\n    });\n  }\n\n  function getStreamInfo() {\n    $('#metadata').empty();\n    $('#info').addClass('hide').hide();\n    if (!selectedStream) return; // Send a request for more info on the mountpoint we subscribed to\n\n    var body = {\n      request: \"info\",\n      id: parseInt(selectedStream) || selectedStream\n    };\n    streaming.send({\n      message: body,\n      success: function (result) {\n        if (result && result.info && result.info.metadata) {\n          $('#metadata').html(result.info.metadata);\n          $('#info').removeClass('hide').show();\n        }\n      }\n    });\n  }\n\n  function startStream() {\n    Janus.log(\"Selected video id #\" + selectedStream);\n\n    if (!selectedStream) {\n      bootbox.alert(\"Select a stream from the list\");\n      return;\n    }\n\n    $('#streamset').attr('disabled', true);\n    $('#streamslist').attr('disabled', true);\n    $('#watch').attr('disabled', true).unbind('click');\n    var body = {\n      request: \"watch\",\n      id: parseInt(selectedStream) || selectedStream\n    };\n    streaming.send({\n      message: body\n    }); // No remote video yet\n\n    $('#stream').append('<video class=\"rounded centered\" id=\"waitingvideo\" width=\"100%\" height=\"100%\" />');\n\n    if (spinner == null) {\n      var target = document.getElementById('stream');\n      spinner = new Spinner({\n        top: 100\n      }).spin(target);\n    } else {\n      spinner.spin();\n    } // Get some more info for the mountpoint to display, if any\n\n\n    getStreamInfo();\n  }\n\n  function stopStream() {\n    $('#watch').attr('disabled', true).unbind('click');\n    var body = {\n      request: \"stop\"\n    };\n    streaming.send({\n      message: body\n    });\n    streaming.hangup();\n    $('#streamset').removeAttr('disabled');\n    $('#streamslist').removeAttr('disabled');\n    $('#watch').html(\"Watch or Listen\").removeAttr('disabled').unbind('click').click(startStream);\n    $('#status').empty().hide();\n    $('#bitrate').attr('disabled', true);\n    $('#bitrateset').html('Bandwidth<span class=\"caret\"></span>');\n    $('#curbitrate').hide();\n    if (bitrateTimer) clearInterval(bitrateTimer);\n    bitrateTimer = null;\n    $('#curres').empty().hide();\n    $('#simulcast').remove();\n    simulcastStarted = false;\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    class: \"container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"row\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"col-md-12\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"page-header\",\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {\n            children: [\"Plugin Demo: Streaming\", /*#__PURE__*/_jsxDEV(\"button\", {\n              class: \"btn btn-default\",\n              autocomplete: \"off\",\n              id: \"start\",\n              children: \"Start\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"container\",\n          id: \"details\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"row\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-md-12\",\n              children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"Demo details\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 419,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"container hide\",\n          id: \"streams\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"col-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"row\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"panel panel-default\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"panel-heading\",\n                  children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                    class: \"panel-title\",\n                    children: [\"Streams \", /*#__PURE__*/_jsxDEV(\"i\", {\n                      id: \"update-streams\",\n                      class: \"fa fa-refresh\",\n                      title: \"Update list of streams\",\n                      style: \"cursor: pointer;\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 428,\n                      columnNumber: 73\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 428,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 427,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"panel-body\",\n                  id: \"list\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    class: \"btn-group btn-group-sm\",\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      class: \"btn btn-primary\",\n                      autocomplete: \"off\",\n                      id: \"watch\",\n                      children: \"Watch or Listen\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 433,\n                      columnNumber: 45\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      class: \"btn-group btn-group-sm\",\n                      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                        autocomplete: \"off\",\n                        id: \"streamset\",\n                        class: \"btn btn-default dropdown-toggle\",\n                        \"data-toggle\": \"dropdown\",\n                        children: [\"Streams list\", /*#__PURE__*/_jsxDEV(\"span\", {\n                          class: \"caret\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 438,\n                          columnNumber: 65\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 436,\n                        columnNumber: 49\n                      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                        id: \"streamslist\",\n                        class: \"dropdown-menu\",\n                        role: \"menu\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 440,\n                        columnNumber: 49\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 435,\n                      columnNumber: 45\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 432,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 431,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 426,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 425,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"row hide\",\n              id: \"info\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"panel panel-default\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"panel-heading\",\n                  children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                    class: \"panel-title\",\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      class: \"fa fa-info-circle\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 450,\n                      columnNumber: 65\n                    }, this), \" Metadata\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 450,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 449,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"panel-body\",\n                  children: /*#__PURE__*/_jsxDEV(\"pre\", {\n                    id: \"metadata\",\n                    style: \"word-break: break-word;\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 453,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 452,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 448,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 424,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"col-md-6\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"panel panel-default\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"panel-heading\",\n                children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                  class: \"panel-title\",\n                  children: [\"Stream\", /*#__PURE__*/_jsxDEV(\"span\", {\n                    class: \"label label-info hide\",\n                    id: \"status\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 462,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    class: \"label label-primary hide\",\n                    id: \"curres\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 463,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    class: \"label label-info hide\",\n                    id: \"curbitrate\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 464,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 461,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 460,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"panel-body\",\n                id: \"stream\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 467,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 459,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 409,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 408,\n    columnNumber: 9\n  }, this);\n}\n\n_c = Stream;\nexport default Stream;\n\nvar _c;\n\n$RefreshReg$(_c, \"Stream\");","map":{"version":3,"sources":["/home/abu/Documents/dev/experiments/exp1/client/src/components/home/Stream.js"],"names":["Axios","React","useContext","useEffect","useState","UserContext","Link","domain","Janus","$","Stream","server","window","location","protocol","hostname","janus","streaming","opaqueId","randomString","bitrateTimer","spinner","selectedStream","document","ready","init","debug","callback","one","attr","unbind","isWebrtcSupported","bootbox","alert","success","attach","plugin","pluginHandle","remove","log","getPlugin","getId","click","updateStreamsList","removeAttr","html","clearInterval","destroy","error","iceState","state","webrtcState","on","onmessage","msg","jsep","result","status","removeClass","text","show","stopStream","substream","temporal","undefined","simulcastStarted","addSimulcastButtons","remoteFeed","videoCodec","updateSimulcastButtons","spatial","svcStarted","addSvcButtons","updateSvcButtons","stereo","sdp","indexOf","createAnswer","media","audioSend","videoSend","data","customizeSdp","replace","body","request","send","message","onremotestream","stream","addButtons","length","append","get","volume","bind","videoWidth","stop","videoTracks","getVideoTracks","width","height","videoHeight","webRTCAdapter","browserDetails","browser","setTimeout","attachMediaStream","play","hide","setInterval","bitrate","getBitrate","ondataopen","ondata","val","oncleanup","empty","addClass","reload","destroyed","myInit","method","id","device","fetch","then","response","json","list","Array","isArray","sort","a","b","filter","includes","mp","parent","startStream","getStreamInfo","parseInt","info","metadata","target","getElementById","Spinner","top","spin","hangup"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,IAAgBC,UAAhB,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAuD,OAAvD;AACA,OAAO,aAAP;AACA,OAAOC,WAAP,MAAwB,2BAAxB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,CAAP,MAAc,QAAd,C,CAGA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAGA,SAASC,MAAT,GAAkB;AAEd,MAAIC,MAAM,GAAG,IAAb;AACA,MAAIC,MAAM,CAACC,QAAP,CAAgBC,QAAhB,KAA6B,OAAjC,EACIH,MAAM,GAAG,YAAYC,MAAM,CAACC,QAAP,CAAgBE,QAA5B,GAAuC,aAAhD,CADJ,KAGIJ,MAAM,GAAG,aAAaC,MAAM,CAACC,QAAP,CAAgBE,QAA7B,GAAwC,aAAjD;AAEJ,MAAIC,KAAK,GAAG,IAAZ;AACA,MAAIC,SAAS,GAAG,IAAhB;AACA,MAAIC,QAAQ,GAAG,mBAAmBV,KAAK,CAACW,YAAN,CAAmB,EAAnB,CAAlC;AAEA,MAAIC,YAAY,GAAG,IAAnB;AACA,MAAIC,OAAO,GAAG,IAAd,CAbc,CAed;;AAEA,MAAIC,cAAc,GAAG,IAArB;AAGAb,EAAAA,CAAC,CAACc,QAAD,CAAD,CAAYC,KAAZ,CAAkB,YAAY;AAC1B;AACAhB,IAAAA,KAAK,CAACiB,IAAN,CAAW;AACPC,MAAAA,KAAK,EAAE,KADA;AACOC,MAAAA,QAAQ,EAAE,YAAY;AAChC;AACAlB,QAAAA,CAAC,CAAC,QAAD,CAAD,CAAYmB,GAAZ,CAAgB,OAAhB,EAAyB,YAAY;AACjCnB,UAAAA,CAAC,CAAC,IAAD,CAAD,CAAQoB,IAAR,CAAa,UAAb,EAAyB,IAAzB,EAA+BC,MAA/B,CAAsC,OAAtC,EADiC,CAEjC;;AACA,cAAI,CAACtB,KAAK,CAACuB,iBAAN,EAAL,EAAgC;AAC5BC,YAAAA,OAAO,CAACC,KAAR,CAAc,uBAAd;AACA;AACH,WANgC,CAOjC;;;AACAjB,UAAAA,KAAK,GAAG,IAAIR,KAAJ,CACJ;AACIG,YAAAA,MAAM,EAAEA,MADZ;AAEIuB,YAAAA,OAAO,EAAE,YAAY;AACjB;AACAlB,cAAAA,KAAK,CAACmB,MAAN,CACI;AACIC,gBAAAA,MAAM,EAAE,wBADZ;AAEIlB,gBAAAA,QAAQ,EAAEA,QAFd;AAGIgB,gBAAAA,OAAO,EAAE,UAAUG,YAAV,EAAwB;AAC7B5B,kBAAAA,CAAC,CAAC,UAAD,CAAD,CAAc6B,MAAd;AACArB,kBAAAA,SAAS,GAAGoB,YAAZ;AACA7B,kBAAAA,KAAK,CAAC+B,GAAN,CAAU,uBAAuBtB,SAAS,CAACuB,SAAV,EAAvB,GAA+C,OAA/C,GAAyDvB,SAAS,CAACwB,KAAV,EAAzD,GAA6E,GAAvF,EAH6B,CAI7B;;AACAhC,kBAAAA,CAAC,CAAC,iBAAD,CAAD,CAAqBiC,KAArB,CAA2BC,iBAA3B;AACAA,kBAAAA,iBAAiB;AACjBlC,kBAAAA,CAAC,CAAC,QAAD,CAAD,CAAYmC,UAAZ,CAAuB,UAAvB,EAAmCC,IAAnC,CAAwC,MAAxC,EACKH,KADL,CACW,YAAY;AACfjC,oBAAAA,CAAC,CAAC,IAAD,CAAD,CAAQoB,IAAR,CAAa,UAAb,EAAyB,IAAzB;AACAiB,oBAAAA,aAAa,CAAC1B,YAAD,CAAb;AACAJ,oBAAAA,KAAK,CAAC+B,OAAN;AACAtC,oBAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBoB,IAAlB,CAAuB,UAAvB,EAAmC,IAAnC;AACApB,oBAAAA,CAAC,CAAC,QAAD,CAAD,CAAYoB,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B,EAAmCC,MAAnC,CAA0C,OAA1C;AACArB,oBAAAA,CAAC,CAAC,QAAD,CAAD,CAAYoB,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B,EAAmCgB,IAAnC,CAAwC,KAAxC,EAA+Cf,MAA/C,CAAsD,OAAtD;AACH,mBARL;AASH,iBAnBL;AAoBIkB,gBAAAA,KAAK,EAAE,UAAUA,KAAV,EAAiB;AACpBxC,kBAAAA,KAAK,CAACwC,KAAN,CAAY,iCAAZ,EAA+CA,KAA/C;AACAhB,kBAAAA,OAAO,CAACC,KAAR,CAAc,+BAA+Be,KAA7C;AACH,iBAvBL;AAwBIC,gBAAAA,QAAQ,EAAE,UAAUC,KAAV,EAAiB;AACvB1C,kBAAAA,KAAK,CAAC+B,GAAN,CAAU,0BAA0BW,KAApC;AACH,iBA1BL;AA2BIC,gBAAAA,WAAW,EAAE,UAAUC,EAAV,EAAc;AACvB5C,kBAAAA,KAAK,CAAC+B,GAAN,CAAU,8CAA8Ca,EAAE,GAAG,IAAH,GAAU,MAA1D,IAAoE,MAA9E;AACH,iBA7BL;AA8BIC,gBAAAA,SAAS,EAAE,UAAUC,GAAV,EAAeC,IAAf,EAAqB;AAC5B/C,kBAAAA,KAAK,CAACkB,KAAN,CAAY,wBAAZ,EAAsC4B,GAAtC;AACA,sBAAIE,MAAM,GAAGF,GAAG,CAAC,QAAD,CAAhB;;AACA,sBAAIE,MAAJ,EAAY;AACR,wBAAIA,MAAM,CAAC,QAAD,CAAV,EAAsB;AAClB,0BAAIC,MAAM,GAAGD,MAAM,CAAC,QAAD,CAAnB;AACA,0BAAIC,MAAM,KAAK,UAAf,EACIhD,CAAC,CAAC,SAAD,CAAD,CAAaiD,WAAb,CAAyB,MAAzB,EAAiCC,IAAjC,CAAsC,0BAAtC,EAAkEC,IAAlE,GADJ,KAEK,IAAIH,MAAM,KAAK,SAAf,EACDhD,CAAC,CAAC,SAAD,CAAD,CAAaiD,WAAb,CAAyB,MAAzB,EAAiCC,IAAjC,CAAsC,SAAtC,EAAiDC,IAAjD,GADC,KAEA,IAAIH,MAAM,KAAK,SAAf,EACDI,UAAU;AACjB,qBARD,MAQO,IAAIP,GAAG,CAAC,WAAD,CAAH,KAAqB,OAAzB,EAAkC;AACrC;AACA,0BAAIQ,SAAS,GAAGN,MAAM,CAAC,WAAD,CAAtB;AACA,0BAAIO,QAAQ,GAAGP,MAAM,CAAC,UAAD,CAArB;;AACA,0BAAKM,SAAS,KAAK,IAAd,IAAsBA,SAAS,KAAKE,SAArC,IAAoDD,QAAQ,KAAK,IAAb,IAAqBA,QAAQ,KAAKC,SAA1F,EAAsG;AAClG,4BAAI,CAACC,gBAAL,EAAuB;AACnBA,0BAAAA,gBAAgB,GAAG,IAAnB;AACAC,0BAAAA,mBAAmB,CAACC,UAAU,CAACC,UAAX,KAA0B,KAA3B,CAAnB;AACH,yBAJiG,CAKlG;;;AACAC,wBAAAA,sBAAsB,CAACP,SAAD,EAAYC,QAAZ,CAAtB;AACH,uBAXoC,CAYrC;;;AACA,0BAAIO,OAAO,GAAGd,MAAM,CAAC,eAAD,CAApB;AACAO,sBAAAA,QAAQ,GAAGP,MAAM,CAAC,gBAAD,CAAjB;;AACA,0BAAKc,OAAO,KAAK,IAAZ,IAAoBA,OAAO,KAAKN,SAAjC,IAAgDD,QAAQ,KAAK,IAAb,IAAqBA,QAAQ,KAAKC,SAAtF,EAAkG;AAC9F,4BAAI,CAACO,UAAL,EAAiB;AACbA,0BAAAA,UAAU,GAAG,IAAb;AACAC,0BAAAA,aAAa;AAChB,yBAJ6F,CAK9F;;;AACAC,wBAAAA,gBAAgB,CAACH,OAAD,EAAUP,QAAV,CAAhB;AACH;AACJ;AACJ,mBAjCD,MAiCO,IAAIT,GAAG,CAAC,OAAD,CAAP,EAAkB;AACrBtB,oBAAAA,OAAO,CAACC,KAAR,CAAcqB,GAAG,CAAC,OAAD,CAAjB;AACAO,oBAAAA,UAAU;AACV;AACH;;AACD,sBAAIN,IAAJ,EAAU;AACN/C,oBAAAA,KAAK,CAACkB,KAAN,CAAY,yBAAZ,EAAuC6B,IAAvC;AACA,wBAAImB,MAAM,GAAInB,IAAI,CAACoB,GAAL,CAASC,OAAT,CAAiB,UAAjB,MAAiC,CAAC,CAAhD,CAFM,CAGN;;AACA3D,oBAAAA,SAAS,CAAC4D,YAAV,CACI;AACItB,sBAAAA,IAAI,EAAEA,IADV;AAEI;AACAuB,sBAAAA,KAAK,EAAE;AAAEC,wBAAAA,SAAS,EAAE,KAAb;AAAoBC,wBAAAA,SAAS,EAAE,KAA/B;AAAsCC,wBAAAA,IAAI,EAAE;AAA5C,uBAHX;AAIIC,sBAAAA,YAAY,EAAE,UAAU3B,IAAV,EAAgB;AAC1B,4BAAImB,MAAM,IAAInB,IAAI,CAACoB,GAAL,CAASC,OAAT,CAAiB,UAAjB,KAAgC,CAAC,CAA/C,EAAkD;AAC9C;AACArB,0BAAAA,IAAI,CAACoB,GAAL,GAAWpB,IAAI,CAACoB,GAAL,CAASQ,OAAT,CAAiB,gBAAjB,EAAmC,yBAAnC,CAAX;AACH;AACJ,uBATL;AAUIjD,sBAAAA,OAAO,EAAE,UAAUqB,IAAV,EAAgB;AACrB/C,wBAAAA,KAAK,CAACkB,KAAN,CAAY,UAAZ,EAAwB6B,IAAxB;AACA,4BAAI6B,IAAI,GAAG;AAAEC,0BAAAA,OAAO,EAAE;AAAX,yBAAX;AACApE,wBAAAA,SAAS,CAACqE,IAAV,CAAe;AAAEC,0BAAAA,OAAO,EAAEH,IAAX;AAAiB7B,0BAAAA,IAAI,EAAEA;AAAvB,yBAAf;AACA9C,wBAAAA,CAAC,CAAC,QAAD,CAAD,CAAYoC,IAAZ,CAAiB,MAAjB,EAAyBD,UAAzB,CAAoC,UAApC,EAAgDF,KAAhD,CAAsDmB,UAAtD;AACH,uBAfL;AAgBIb,sBAAAA,KAAK,EAAE,UAAUA,KAAV,EAAiB;AACpBxC,wBAAAA,KAAK,CAACwC,KAAN,CAAY,eAAZ,EAA6BA,KAA7B;AACAhB,wBAAAA,OAAO,CAACC,KAAR,CAAc,qBAAqBe,KAAK,CAACuC,OAAzC;AACH;AAnBL,qBADJ;AAsBH;AACJ,iBAlGL;AAmGIC,gBAAAA,cAAc,EAAE,UAAUC,MAAV,EAAkB;AAC9BjF,kBAAAA,KAAK,CAACkB,KAAN,CAAY,8BAAZ,EAA4C+D,MAA5C;AACA,sBAAIC,UAAU,GAAG,KAAjB;;AACA,sBAAIjF,CAAC,CAAC,cAAD,CAAD,CAAkBkF,MAAlB,KAA6B,CAAjC,EAAoC;AAChCD,oBAAAA,UAAU,GAAG,IAAb;AACAjF,oBAAAA,CAAC,CAAC,SAAD,CAAD,CAAamF,MAAb,CAAoB,gGAApB;AACAnF,oBAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBoF,GAAlB,CAAsB,CAAtB,EAAyBC,MAAzB,GAAkC,CAAlC,CAHgC,CAIhC;;AACArF,oBAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBsF,IAAlB,CAAuB,SAAvB,EAAkC,YAAY;AAC1CtF,sBAAAA,CAAC,CAAC,eAAD,CAAD,CAAmB6B,MAAnB;AACA,0BAAI,KAAK0D,UAAT,EACIvF,CAAC,CAAC,cAAD,CAAD,CAAkBiD,WAAlB,CAA8B,MAA9B,EAAsCE,IAAtC;AACJ,0BAAIvC,OAAJ,EACIA,OAAO,CAAC4E,IAAR;AACJ5E,sBAAAA,OAAO,GAAG,IAAV;AACA,0BAAI6E,WAAW,GAAGT,MAAM,CAACU,cAAP,EAAlB;AACA,0BAAI,CAACD,WAAD,IAAgBA,WAAW,CAACP,MAAZ,KAAuB,CAA3C,EACI;AACJ,0BAAIS,KAAK,GAAG,KAAKJ,UAAjB;AACA,0BAAIK,MAAM,GAAG,KAAKC,WAAlB;AACA7F,sBAAAA,CAAC,CAAC,SAAD,CAAD,CAAaiD,WAAb,CAAyB,MAAzB,EAAiCC,IAAjC,CAAsCyC,KAAK,GAAG,GAAR,GAAcC,MAApD,EAA4DzC,IAA5D;;AACA,0BAAIpD,KAAK,CAAC+F,aAAN,CAAoBC,cAApB,CAAmCC,OAAnC,KAA+C,SAAnD,EAA8D;AAC1D;AACAC,wBAAAA,UAAU,CAAC,YAAY;AACnB,8BAAIN,KAAK,GAAG3F,CAAC,CAAC,cAAD,CAAD,CAAkBoF,GAAlB,CAAsB,CAAtB,EAAyBG,UAArC;AACA,8BAAIK,MAAM,GAAG5F,CAAC,CAAC,cAAD,CAAD,CAAkBoF,GAAlB,CAAsB,CAAtB,EAAyBS,WAAtC;AACA7F,0BAAAA,CAAC,CAAC,SAAD,CAAD,CAAaiD,WAAb,CAAyB,MAAzB,EAAiCC,IAAjC,CAAsCyC,KAAK,GAAG,GAAR,GAAcC,MAApD,EAA4DzC,IAA5D;AACH,yBAJS,EAIP,IAJO,CAAV;AAKH;AACJ,qBArBD;AAsBH;;AACDpD,kBAAAA,KAAK,CAACmG,iBAAN,CAAwBlG,CAAC,CAAC,cAAD,CAAD,CAAkBoF,GAAlB,CAAsB,CAAtB,CAAxB,EAAkDJ,MAAlD;AACAhF,kBAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBoF,GAAlB,CAAsB,CAAtB,EAAyBe,IAAzB;AACAnG,kBAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBoF,GAAlB,CAAsB,CAAtB,EAAyBC,MAAzB,GAAkC,CAAlC;AACA,sBAAII,WAAW,GAAGT,MAAM,CAACU,cAAP,EAAlB;;AACA,sBAAI,CAACD,WAAD,IAAgBA,WAAW,CAACP,MAAZ,KAAuB,CAA3C,EAA8C;AAC1C;AACAlF,oBAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBoG,IAAlB;;AACA,wBAAIpG,CAAC,CAAC,6BAAD,CAAD,CAAiCkF,MAAjC,KAA4C,CAAhD,EAAmD;AAC/ClF,sBAAAA,CAAC,CAAC,SAAD,CAAD,CAAamF,MAAb,CACI,qCACA,uDADA,GAEA,8DAFA,GAGA,QAJJ;AAKH;AACJ,mBAVD,MAUO;AACHnF,oBAAAA,CAAC,CAAC,6BAAD,CAAD,CAAiC6B,MAAjC;AACA7B,oBAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBiD,WAAlB,CAA8B,MAA9B,EAAsCE,IAAtC;AACH;;AACD,sBAAI,CAAC8B,UAAL,EACI;;AACJ,sBAAIQ,WAAW,IAAIA,WAAW,CAACP,MAA3B,KACCnF,KAAK,CAAC+F,aAAN,CAAoBC,cAApB,CAAmCC,OAAnC,KAA+C,QAA/C,IACGjG,KAAK,CAAC+F,aAAN,CAAoBC,cAApB,CAAmCC,OAAnC,KAA+C,SADlD,IAEGjG,KAAK,CAAC+F,aAAN,CAAoBC,cAApB,CAAmCC,OAAnC,KAA+C,QAHnD,CAAJ,EAGkE;AAC9DhG,oBAAAA,CAAC,CAAC,aAAD,CAAD,CAAiBiD,WAAjB,CAA6B,MAA7B,EAAqCE,IAArC;AACAxC,oBAAAA,YAAY,GAAG0F,WAAW,CAAC,YAAY;AACnC;AACA,0BAAIC,OAAO,GAAG9F,SAAS,CAAC+F,UAAV,EAAd;AACAvG,sBAAAA,CAAC,CAAC,aAAD,CAAD,CAAiBkD,IAAjB,CAAsBoD,OAAtB,EAHmC,CAInC;;AACA,0BAAIX,KAAK,GAAG3F,CAAC,CAAC,cAAD,CAAD,CAAkBoF,GAAlB,CAAsB,CAAtB,EAAyBG,UAArC;AACA,0BAAIK,MAAM,GAAG5F,CAAC,CAAC,cAAD,CAAD,CAAkBoF,GAAlB,CAAsB,CAAtB,EAAyBS,WAAtC;AACA,0BAAIF,KAAK,GAAG,CAAR,IAAaC,MAAM,GAAG,CAA1B,EACI5F,CAAC,CAAC,SAAD,CAAD,CAAaiD,WAAb,CAAyB,MAAzB,EAAiCC,IAAjC,CAAsCyC,KAAK,GAAG,GAAR,GAAcC,MAApD,EAA4DzC,IAA5D;AACP,qBATyB,EASvB,IATuB,CAA1B;AAUH;AACJ,iBAtKL;AAuKIqD,gBAAAA,UAAU,EAAE,UAAUhC,IAAV,EAAgB;AACxBzE,kBAAAA,KAAK,CAAC+B,GAAN,CAAU,+BAAV;AACA9B,kBAAAA,CAAC,CAAC,eAAD,CAAD,CAAmB6B,MAAnB;AACA7B,kBAAAA,CAAC,CAAC,SAAD,CAAD,CAAamF,MAAb,CACI,yEADJ;AAGA,sBAAIvE,OAAJ,EACIA,OAAO,CAAC4E,IAAR;AACJ5E,kBAAAA,OAAO,GAAG,IAAV;AACH,iBAhLL;AAiLI6F,gBAAAA,MAAM,EAAE,UAAUjC,IAAV,EAAgB;AACpBzE,kBAAAA,KAAK,CAACkB,KAAN,CAAY,mCAAZ,EAAiDuD,IAAjD;AACAxE,kBAAAA,CAAC,CAAC,WAAD,CAAD,CAAe0G,GAAf,CAAmBlC,IAAnB;AACH,iBApLL;AAqLImC,gBAAAA,SAAS,EAAE,YAAY;AACnB5G,kBAAAA,KAAK,CAAC+B,GAAN,CAAU,qCAAV;AACA9B,kBAAAA,CAAC,CAAC,eAAD,CAAD,CAAmB6B,MAAnB;AACA7B,kBAAAA,CAAC,CAAC,cAAD,CAAD,CAAkB6B,MAAlB;AACA7B,kBAAAA,CAAC,CAAC,WAAD,CAAD,CAAe6B,MAAf;AACA7B,kBAAAA,CAAC,CAAC,qBAAD,CAAD,CAAyB6B,MAAzB;AACA7B,kBAAAA,CAAC,CAAC,UAAD,CAAD,CAAcoB,IAAd,CAAmB,UAAnB,EAA+B,IAA/B;AACApB,kBAAAA,CAAC,CAAC,aAAD,CAAD,CAAiBoC,IAAjB,CAAsB,sCAAtB;AACApC,kBAAAA,CAAC,CAAC,aAAD,CAAD,CAAiBoG,IAAjB;AACA,sBAAIzF,YAAJ,EACI0B,aAAa,CAAC1B,YAAD,CAAb;AACJA,kBAAAA,YAAY,GAAG,IAAf;AACAX,kBAAAA,CAAC,CAAC,SAAD,CAAD,CAAaoG,IAAb;AACApG,kBAAAA,CAAC,CAAC,YAAD,CAAD,CAAgB6B,MAAhB;AACA7B,kBAAAA,CAAC,CAAC,WAAD,CAAD,CAAe4G,KAAf;AACA5G,kBAAAA,CAAC,CAAC,OAAD,CAAD,CAAW6G,QAAX,CAAoB,MAApB,EAA4BT,IAA5B;AACA5C,kBAAAA,gBAAgB,GAAG,KAAnB;AACH;AAtML,eADJ;AAyMH,aA7ML;AA8MIjB,YAAAA,KAAK,EAAE,UAAUA,KAAV,EAAiB;AACpBxC,cAAAA,KAAK,CAACwC,KAAN,CAAYA,KAAZ;AACAhB,cAAAA,OAAO,CAACC,KAAR,CAAce,KAAd,EAAqB,YAAY;AAC7BpC,gBAAAA,MAAM,CAACC,QAAP,CAAgB0G,MAAhB;AACH,eAFD;AAGH,aAnNL;AAoNIC,YAAAA,SAAS,EAAE,YAAY;AACnB5G,cAAAA,MAAM,CAACC,QAAP,CAAgB0G,MAAhB;AACH;AAtNL,WADI,CAAR;AAyNH,SAjOD;AAkOH;AArOM,KAAX;AAuOH,GAzOD;;AA2OA,iBAAe5E,iBAAf,GAAmC;AAC/BnC,IAAAA,KAAK,CAACkB,KAAN,CAAY,mBAAZ;AAEA,UAAM+F,MAAM,GAAG;AACXC,MAAAA,MAAM,EAAE;AADG,KAAf,CAH+B,CAM/B;AAEA;;AACA,UAAMC,EAAE,GAAG,0BAAX;AACA,UAAMC,MAAM,GAAG,MAAMC,KAAK,CAAE,oCAAmCF,EAAG,SAAxC,EAAkDF,MAAlD,CAAL,CAChBK,IADgB,CACXC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADD,EAEhBF,IAFgB,CAEX7C,IAAI,IAAIA,IAAI,CAAC2C,MAFF,CAArB;AAIApH,IAAAA,KAAK,CAAC+B,GAAN,CAAU,iBAAV,EAA6BqF,MAA7B;AAEAnH,IAAAA,CAAC,CAAC,iBAAD,CAAD,CAAqBqB,MAArB,CAA4B,OAA5B,EAAqCwF,QAArC,CAA8C,SAA9C;AACA,QAAIlC,IAAI,GAAG;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAAX;AACA7E,IAAAA,KAAK,CAACkB,KAAN,CAAY,kBAAZ,EAAgC0D,IAAhC;AACAnE,IAAAA,SAAS,CAACqE,IAAV,CAAe;AACXC,MAAAA,OAAO,EAAEH,IADE;AACIlD,MAAAA,OAAO,EAAE,UAAUsB,MAAV,EAAkB;AACtCkD,QAAAA,UAAU,CAAC,YAAY;AACnBjG,UAAAA,CAAC,CAAC,iBAAD,CAAD,CAAqBiD,WAArB,CAAiC,SAAjC,EAA4ChB,KAA5C,CAAkDC,iBAAlD;AACH,SAFS,EAEP,GAFO,CAAV;;AAGA,YAAI,CAACa,MAAL,EAAa;AACTxB,UAAAA,OAAO,CAACC,KAAR,CAAc,oDAAd;AACA;AACH;;AACD,YAAIuB,MAAM,CAAC,MAAD,CAAV,EAAoB;AAChB/C,UAAAA,CAAC,CAAC,UAAD,CAAD,CAAciD,WAAd,CAA0B,MAA1B,EAAkCE,IAAlC;AACAnD,UAAAA,CAAC,CAAC,cAAD,CAAD,CAAkB4G,KAAlB;AACA5G,UAAAA,CAAC,CAAC,QAAD,CAAD,CAAYoB,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B,EAAmCC,MAAnC,CAA0C,OAA1C;AACA,cAAImG,IAAI,GAAGzE,MAAM,CAAC,MAAD,CAAjB;AACAhD,UAAAA,KAAK,CAAC+B,GAAN,CAAU,iCAAV;;AACA,cAAI0F,IAAI,IAAIC,KAAK,CAACC,OAAN,CAAcF,IAAd,CAAZ,EAAiC;AAC7BA,YAAAA,IAAI,CAACG,IAAL,CAAU,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AACtB,kBAAI,CAACD,CAAD,IAAMA,CAAC,CAACV,EAAF,IAAQW,CAAC,GAAGA,CAAC,CAACX,EAAL,GAAU,CAAnB,CAAV,EACI,OAAO,CAAC,CAAR;AACJ,kBAAI,CAACW,CAAD,IAAMA,CAAC,CAACX,EAAF,IAAQU,CAAC,GAAGA,CAAC,CAACV,EAAL,GAAU,CAAnB,CAAV,EACI,OAAO,CAAP;AACJ,qBAAO,CAAP;AACH,aAND;AAOH;;AACDnH,UAAAA,KAAK,CAACkB,KAAN,CAAYuG,IAAZ;AAEAA,UAAAA,IAAI,GAAGA,IAAI,CAACM,MAAL,CAAY9C,MAAM,IAAImC,MAAM,CAACY,QAAP,CAAgB/C,MAAM,CAACkC,EAAP,GAAY,EAA5B,CAAtB,CAAP;AAEAnH,UAAAA,KAAK,CAAC+B,GAAN,CAAU,kBAAV,EAA8B0F,IAA9B;;AAEA,eAAK,IAAIQ,EAAT,IAAeR,IAAf,EAAqB;AACjBzH,YAAAA,KAAK,CAACkB,KAAN,CAAY,WAAWuG,IAAI,CAACQ,EAAD,CAAJ,CAAS,IAAT,CAAX,GAA4B,IAA5B,GAAmCR,IAAI,CAACQ,EAAD,CAAJ,CAAS,aAAT,CAAnC,GAA6D,IAA7D,GAAoER,IAAI,CAACQ,EAAD,CAAJ,CAAS,MAAT,CAApE,GAAuF,GAAnG;AACAhI,YAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBmF,MAAlB,CAAyB,yBAAyBqC,IAAI,CAACQ,EAAD,CAAJ,CAAS,IAAT,CAAzB,GAA0C,IAA1C,GAAiDR,IAAI,CAACQ,EAAD,CAAJ,CAAS,aAAT,CAAjD,GAA2E,IAA3E,GAAkFR,IAAI,CAACQ,EAAD,CAAJ,CAAS,MAAT,CAAlF,GAAqG,GAArG,GAA2G,WAApI;AACH;;AACDhI,UAAAA,CAAC,CAAC,gBAAD,CAAD,CAAoBqB,MAApB,CAA2B,OAA3B,EAAoCY,KAApC,CAA0C,YAAY;AAClDpB,YAAAA,cAAc,GAAGb,CAAC,CAAC,IAAD,CAAD,CAAQoB,IAAR,CAAa,IAAb,CAAjB;AACApB,YAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBoC,IAAhB,CAAqBpC,CAAC,CAAC,IAAD,CAAD,CAAQoC,IAAR,EAArB,EAAqC6F,MAArC,GAA8ChF,WAA9C,CAA0D,MAA1D;AACA,mBAAO,KAAP;AAEH,WALD;AAMAjD,UAAAA,CAAC,CAAC,QAAD,CAAD,CAAYmC,UAAZ,CAAuB,UAAvB,EAAmCd,MAAnC,CAA0C,OAA1C,EAAmDY,KAAnD,CAAyDiG,WAAzD;AACH;AACJ;AA1CU,KAAf;AA4CH;;AAED,WAASC,aAAT,GAAyB;AACrBnI,IAAAA,CAAC,CAAC,WAAD,CAAD,CAAe4G,KAAf;AACA5G,IAAAA,CAAC,CAAC,OAAD,CAAD,CAAW6G,QAAX,CAAoB,MAApB,EAA4BT,IAA5B;AACA,QAAI,CAACvF,cAAL,EACI,OAJiB,CAKrB;;AACA,QAAI8D,IAAI,GAAG;AAAEC,MAAAA,OAAO,EAAE,MAAX;AAAmBsC,MAAAA,EAAE,EAAEkB,QAAQ,CAACvH,cAAD,CAAR,IAA4BA;AAAnD,KAAX;AACAL,IAAAA,SAAS,CAACqE,IAAV,CAAe;AACXC,MAAAA,OAAO,EAAEH,IADE;AACIlD,MAAAA,OAAO,EAAE,UAAUsB,MAAV,EAAkB;AACtC,YAAIA,MAAM,IAAIA,MAAM,CAACsF,IAAjB,IAAyBtF,MAAM,CAACsF,IAAP,CAAYC,QAAzC,EAAmD;AAC/CtI,UAAAA,CAAC,CAAC,WAAD,CAAD,CAAeoC,IAAf,CAAoBW,MAAM,CAACsF,IAAP,CAAYC,QAAhC;AACAtI,UAAAA,CAAC,CAAC,OAAD,CAAD,CAAWiD,WAAX,CAAuB,MAAvB,EAA+BE,IAA/B;AACH;AACJ;AANU,KAAf;AAQH;;AAED,WAAS+E,WAAT,GAAuB;AACnBnI,IAAAA,KAAK,CAAC+B,GAAN,CAAU,wBAAwBjB,cAAlC;;AACA,QAAI,CAACA,cAAL,EAAqB;AACjBU,MAAAA,OAAO,CAACC,KAAR,CAAc,+BAAd;AACA;AACH;;AACDxB,IAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBoB,IAAhB,CAAqB,UAArB,EAAiC,IAAjC;AACApB,IAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBoB,IAAlB,CAAuB,UAAvB,EAAmC,IAAnC;AACApB,IAAAA,CAAC,CAAC,QAAD,CAAD,CAAYoB,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B,EAAmCC,MAAnC,CAA0C,OAA1C;AACA,QAAIsD,IAAI,GAAG;AAAEC,MAAAA,OAAO,EAAE,OAAX;AAAoBsC,MAAAA,EAAE,EAAEkB,QAAQ,CAACvH,cAAD,CAAR,IAA4BA;AAApD,KAAX;AACAL,IAAAA,SAAS,CAACqE,IAAV,CAAe;AAAEC,MAAAA,OAAO,EAAEH;AAAX,KAAf,EAVmB,CAWnB;;AACA3E,IAAAA,CAAC,CAAC,SAAD,CAAD,CAAamF,MAAb,CAAoB,iFAApB;;AACA,QAAIvE,OAAO,IAAI,IAAf,EAAqB;AACjB,UAAI2H,MAAM,GAAGzH,QAAQ,CAAC0H,cAAT,CAAwB,QAAxB,CAAb;AACA5H,MAAAA,OAAO,GAAG,IAAI6H,OAAJ,CAAY;AAAEC,QAAAA,GAAG,EAAE;AAAP,OAAZ,EAA0BC,IAA1B,CAA+BJ,MAA/B,CAAV;AACH,KAHD,MAGO;AACH3H,MAAAA,OAAO,CAAC+H,IAAR;AACH,KAlBkB,CAmBnB;;;AACAR,IAAAA,aAAa;AAChB;;AAED,WAAS/E,UAAT,GAAsB;AAClBpD,IAAAA,CAAC,CAAC,QAAD,CAAD,CAAYoB,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B,EAAmCC,MAAnC,CAA0C,OAA1C;AACA,QAAIsD,IAAI,GAAG;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAAX;AACApE,IAAAA,SAAS,CAACqE,IAAV,CAAe;AAAEC,MAAAA,OAAO,EAAEH;AAAX,KAAf;AACAnE,IAAAA,SAAS,CAACoI,MAAV;AACA5I,IAAAA,CAAC,CAAC,YAAD,CAAD,CAAgBmC,UAAhB,CAA2B,UAA3B;AACAnC,IAAAA,CAAC,CAAC,cAAD,CAAD,CAAkBmC,UAAlB,CAA6B,UAA7B;AACAnC,IAAAA,CAAC,CAAC,QAAD,CAAD,CAAYoC,IAAZ,CAAiB,iBAAjB,EAAoCD,UAApC,CAA+C,UAA/C,EAA2Dd,MAA3D,CAAkE,OAAlE,EAA2EY,KAA3E,CAAiFiG,WAAjF;AACAlI,IAAAA,CAAC,CAAC,SAAD,CAAD,CAAa4G,KAAb,GAAqBR,IAArB;AACApG,IAAAA,CAAC,CAAC,UAAD,CAAD,CAAcoB,IAAd,CAAmB,UAAnB,EAA+B,IAA/B;AACApB,IAAAA,CAAC,CAAC,aAAD,CAAD,CAAiBoC,IAAjB,CAAsB,sCAAtB;AACApC,IAAAA,CAAC,CAAC,aAAD,CAAD,CAAiBoG,IAAjB;AACA,QAAIzF,YAAJ,EACI0B,aAAa,CAAC1B,YAAD,CAAb;AACJA,IAAAA,YAAY,GAAG,IAAf;AACAX,IAAAA,CAAC,CAAC,SAAD,CAAD,CAAa4G,KAAb,GAAqBR,IAArB;AACApG,IAAAA,CAAC,CAAC,YAAD,CAAD,CAAgB6B,MAAhB;AACA2B,IAAAA,gBAAgB,GAAG,KAAnB;AACH;;AAED,sBACI;AAAK,IAAA,KAAK,EAAC,WAAX;AAAA,2BACI;AAAK,MAAA,KAAK,EAAC,KAAX;AAAA,6BACI;AAAK,QAAA,KAAK,EAAC,WAAX;AAAA,gCACI;AAAK,UAAA,KAAK,EAAC,aAAX;AAAA,iCACI;AAAA,8DACI;AAAQ,cAAA,KAAK,EAAC,iBAAd;AAAgC,cAAA,YAAY,EAAC,KAA7C;AAAmD,cAAA,EAAE,EAAC,OAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBADJ,eAMI;AAAK,UAAA,KAAK,EAAC,WAAX;AAAuB,UAAA,EAAE,EAAC,SAA1B;AAAA,iCACI;AAAK,YAAA,KAAK,EAAC,KAAX;AAAA,mCACI;AAAK,cAAA,KAAK,EAAC,WAAX;AAAA,qCACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,gBANJ,eAaI;AAAK,UAAA,KAAK,EAAC,gBAAX;AAA4B,UAAA,EAAE,EAAC,SAA/B;AAAA,kCACI;AAAK,YAAA,KAAK,EAAC,UAAX;AAAA,oCACI;AAAK,cAAA,KAAK,EAAC,KAAX;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAC,qBAAX;AAAA,wCACI;AAAK,kBAAA,KAAK,EAAC,eAAX;AAAA,yCACI;AAAI,oBAAA,KAAK,EAAC,aAAV;AAAA,wDAAgC;AAAG,sBAAA,EAAE,EAAC,gBAAN;AAAuB,sBAAA,KAAK,EAAC,eAA7B;AAC5B,sBAAA,KAAK,EAAC,wBADsB;AACG,sBAAA,KAAK,EAAC;AADT;AAAA;AAAA;AAAA;AAAA,4BAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBADJ,eAKI;AAAK,kBAAA,KAAK,EAAC,YAAX;AAAwB,kBAAA,EAAE,EAAC,MAA3B;AAAA,yCACI;AAAK,oBAAA,KAAK,EAAC,wBAAX;AAAA,4CACI;AAAQ,sBAAA,KAAK,EAAC,iBAAd;AAAgC,sBAAA,YAAY,EAAC,KAA7C;AAAmD,sBAAA,EAAE,EAAC,OAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADJ,eAGI;AAAK,sBAAA,KAAK,EAAC,wBAAX;AAAA,8CACI;AAAQ,wBAAA,YAAY,EAAC,KAArB;AAA2B,wBAAA,EAAE,EAAC,WAA9B;AACI,wBAAA,KAAK,EAAC,iCADV;AAC4C,uCAAY,UADxD;AAAA,gEAEgB;AAAM,0BAAA,KAAK,EAAC;AAAZ;AAAA;AAAA;AAAA;AAAA,gCAFhB;AAAA;AAAA;AAAA;AAAA;AAAA,8BADJ,eAKI;AAAI,wBAAA,EAAE,EAAC,aAAP;AAAqB,wBAAA,KAAK,EAAC,eAA3B;AAA2C,wBAAA,IAAI,EAAC;AAAhD;AAAA;AAAA;AAAA;AAAA,8BALJ;AAAA;AAAA;AAAA;AAAA;AAAA,4BAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBALJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,oBADJ,eAuBI;AAAK,cAAA,KAAK,EAAC,UAAX;AAAsB,cAAA,EAAE,EAAC,MAAzB;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAC,qBAAX;AAAA,wCACI;AAAK,kBAAA,KAAK,EAAC,eAAX;AAAA,yCACI;AAAI,oBAAA,KAAK,EAAC,aAAV;AAAA,4CAAwB;AAAG,sBAAA,KAAK,EAAC;AAAT;AAAA;AAAA;AAAA;AAAA,4BAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBADJ,eAII;AAAK,kBAAA,KAAK,EAAC,YAAX;AAAA,yCACI;AAAK,oBAAA,EAAE,EAAC,UAAR;AAAmB,oBAAA,KAAK,EAAC;AAAzB;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBAJJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,oBAvBJ;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,eAmCI;AAAK,YAAA,KAAK,EAAC,UAAX;AAAA,mCACI;AAAK,cAAA,KAAK,EAAC,qBAAX;AAAA,sCACI;AAAK,gBAAA,KAAK,EAAC,eAAX;AAAA,uCACI;AAAI,kBAAA,KAAK,EAAC,aAAV;AAAA,oDACI;AAAM,oBAAA,KAAK,EAAC,uBAAZ;AAAoC,oBAAA,EAAE,EAAC;AAAvC;AAAA;AAAA;AAAA;AAAA,0BADJ,eAEI;AAAM,oBAAA,KAAK,EAAC,0BAAZ;AAAuC,oBAAA,EAAE,EAAC;AAA1C;AAAA;AAAA;AAAA;AAAA,0BAFJ,eAGI;AAAM,oBAAA,KAAK,EAAC,uBAAZ;AAAoC,oBAAA,EAAE,EAAC;AAAvC;AAAA;AAAA;AAAA;AAAA,0BAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBADJ,eAQI;AAAK,gBAAA,KAAK,EAAC,YAAX;AAAwB,gBAAA,EAAE,EAAC;AAA3B;AAAA;AAAA;AAAA;AAAA,sBARJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,kBAnCJ;AAAA;AAAA;AAAA;AAAA;AAAA,gBAbJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,UADJ;AAqEH;;KAjcQvD,M;AAkcT,eAAeA,MAAf","sourcesContent":["import Axios from \"axios\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport \"./Home.scss\";\nimport UserContext from \"../../context/UserContext\";\nimport { Link } from \"react-router-dom\";\nimport domain from \"../../util/domain\";\nimport Janus from './Janus';\nimport $ from 'jquery';\n\n\n// function Stream() {\n\n//     const { user } = useContext(UserContext);\n\n//     return (\n//         <div className=\"home\">\n//             {(user && (\n//                 <div className=\"no-user-message\">\n//                     <h2>Here is the stream</h2>\n//                 </div>\n//             ))}\n//         </div>\n//     );\n// }\n\n\nfunction Stream() {\n\n    var server = null;\n    if (window.location.protocol === 'http:')\n        server = \"http://\" + window.location.hostname + \":8088/janus\";\n    else\n        server = \"https://\" + window.location.hostname + \":8089/janus\";\n\n    var janus = null;\n    var streaming = null;\n    var opaqueId = \"streamingtest-\" + Janus.randomString(12);\n\n    var bitrateTimer = null;\n    var spinner = null;\n\n    // var simulcastStarted = false, svcStarted = false;\n\n    var selectedStream = null;\n\n\n    $(document).ready(function () {\n        // Initialize the library (all console debuggers enabled)\n        Janus.init({\n            debug: \"all\", callback: function () {\n                // Use a button to start the demo\n                $('#start').one('click', function () {\n                    $(this).attr('disabled', true).unbind('click');\n                    // Make sure the browser supports WebRTC\n                    if (!Janus.isWebrtcSupported()) {\n                        bootbox.alert(\"No WebRTC support... \");\n                        return;\n                    }\n                    // Create session\n                    janus = new Janus(\n                        {\n                            server: server,\n                            success: function () {\n                                // Attach to Streaming plugin\n                                janus.attach(\n                                    {\n                                        plugin: \"janus.plugin.streaming\",\n                                        opaqueId: opaqueId,\n                                        success: function (pluginHandle) {\n                                            $('#details').remove();\n                                            streaming = pluginHandle;\n                                            Janus.log(\"Plugin attached! (\" + streaming.getPlugin() + \", id=\" + streaming.getId() + \")\");\n                                            // Setup streaming session\n                                            $('#update-streams').click(updateStreamsList);\n                                            updateStreamsList();\n                                            $('#start').removeAttr('disabled').html(\"Stop\")\n                                                .click(function () {\n                                                    $(this).attr('disabled', true);\n                                                    clearInterval(bitrateTimer);\n                                                    janus.destroy();\n                                                    $('#streamslist').attr('disabled', true);\n                                                    $('#watch').attr('disabled', true).unbind('click');\n                                                    $('#start').attr('disabled', true).html(\"Bye\").unbind('click');\n                                                });\n                                        },\n                                        error: function (error) {\n                                            Janus.error(\"  -- Error attaching plugin... \", error);\n                                            bootbox.alert(\"Error attaching plugin... \" + error);\n                                        },\n                                        iceState: function (state) {\n                                            Janus.log(\"ICE state changed to \" + state);\n                                        },\n                                        webrtcState: function (on) {\n                                            Janus.log(\"Janus says our WebRTC PeerConnection is \" + (on ? \"up\" : \"down\") + \" now\");\n                                        },\n                                        onmessage: function (msg, jsep) {\n                                            Janus.debug(\" ::: Got a message :::\", msg);\n                                            var result = msg[\"result\"];\n                                            if (result) {\n                                                if (result[\"status\"]) {\n                                                    var status = result[\"status\"];\n                                                    if (status === 'starting')\n                                                        $('#status').removeClass('hide').text(\"Starting, please wait...\").show();\n                                                    else if (status === 'started')\n                                                        $('#status').removeClass('hide').text(\"Started\").show();\n                                                    else if (status === 'stopped')\n                                                        stopStream();\n                                                } else if (msg[\"streaming\"] === \"event\") {\n                                                    // Is simulcast in place?\n                                                    var substream = result[\"substream\"];\n                                                    var temporal = result[\"temporal\"];\n                                                    if ((substream !== null && substream !== undefined) || (temporal !== null && temporal !== undefined)) {\n                                                        if (!simulcastStarted) {\n                                                            simulcastStarted = true;\n                                                            addSimulcastButtons(remoteFeed.videoCodec === \"vp8\");\n                                                        }\n                                                        // We just received notice that there's been a switch, update the buttons\n                                                        updateSimulcastButtons(substream, temporal);\n                                                    }\n                                                    // Is VP9/SVC in place?\n                                                    var spatial = result[\"spatial_layer\"];\n                                                    temporal = result[\"temporal_layer\"];\n                                                    if ((spatial !== null && spatial !== undefined) || (temporal !== null && temporal !== undefined)) {\n                                                        if (!svcStarted) {\n                                                            svcStarted = true;\n                                                            addSvcButtons();\n                                                        }\n                                                        // We just received notice that there's been a switch, update the buttons\n                                                        updateSvcButtons(spatial, temporal);\n                                                    }\n                                                }\n                                            } else if (msg[\"error\"]) {\n                                                bootbox.alert(msg[\"error\"]);\n                                                stopStream();\n                                                return;\n                                            }\n                                            if (jsep) {\n                                                Janus.debug(\"Handling SDP as well...\", jsep);\n                                                var stereo = (jsep.sdp.indexOf(\"stereo=1\") !== -1);\n                                                // Offer from the plugin, let's answer\n                                                streaming.createAnswer(\n                                                    {\n                                                        jsep: jsep,\n                                                        // We want recvonly audio/video and, if negotiated, datachannels\n                                                        media: { audioSend: false, videoSend: false, data: true },\n                                                        customizeSdp: function (jsep) {\n                                                            if (stereo && jsep.sdp.indexOf(\"stereo=1\") == -1) {\n                                                                // Make sure that our offer contains stereo too\n                                                                jsep.sdp = jsep.sdp.replace(\"useinbandfec=1\", \"useinbandfec=1;stereo=1\");\n                                                            }\n                                                        },\n                                                        success: function (jsep) {\n                                                            Janus.debug(\"Got SDP!\", jsep);\n                                                            var body = { request: \"start\" };\n                                                            streaming.send({ message: body, jsep: jsep });\n                                                            $('#watch').html(\"Stop\").removeAttr('disabled').click(stopStream);\n                                                        },\n                                                        error: function (error) {\n                                                            Janus.error(\"WebRTC error:\", error);\n                                                            bootbox.alert(\"WebRTC error... \" + error.message);\n                                                        }\n                                                    });\n                                            }\n                                        },\n                                        onremotestream: function (stream) {\n                                            Janus.debug(\" ::: Got a remote stream :::\", stream);\n                                            var addButtons = false;\n                                            if ($('#remotevideo').length === 0) {\n                                                addButtons = true;\n                                                $('#stream').append('<video class=\"rounded centered hide\" id=\"remotevideo\" width=\"100%\" height=\"100%\" playsinline/>');\n                                                $('#remotevideo').get(0).volume = 0;\n                                                // Show the stream and hide the spinner when we get a playing event\n                                                $(\"#remotevideo\").bind(\"playing\", function () {\n                                                    $('#waitingvideo').remove();\n                                                    if (this.videoWidth)\n                                                        $('#remotevideo').removeClass('hide').show();\n                                                    if (spinner)\n                                                        spinner.stop();\n                                                    spinner = null;\n                                                    var videoTracks = stream.getVideoTracks();\n                                                    if (!videoTracks || videoTracks.length === 0)\n                                                        return;\n                                                    var width = this.videoWidth;\n                                                    var height = this.videoHeight;\n                                                    $('#curres').removeClass('hide').text(width + 'x' + height).show();\n                                                    if (Janus.webRTCAdapter.browserDetails.browser === \"firefox\") {\n                                                        // Firefox Stable has a bug: width and height are not immediately available after a playing\n                                                        setTimeout(function () {\n                                                            var width = $(\"#remotevideo\").get(0).videoWidth;\n                                                            var height = $(\"#remotevideo\").get(0).videoHeight;\n                                                            $('#curres').removeClass('hide').text(width + 'x' + height).show();\n                                                        }, 2000);\n                                                    }\n                                                });\n                                            }\n                                            Janus.attachMediaStream($('#remotevideo').get(0), stream);\n                                            $(\"#remotevideo\").get(0).play();\n                                            $(\"#remotevideo\").get(0).volume = 1;\n                                            var videoTracks = stream.getVideoTracks();\n                                            if (!videoTracks || videoTracks.length === 0) {\n                                                // No remote video\n                                                $('#remotevideo').hide();\n                                                if ($('#stream .no-video-container').length === 0) {\n                                                    $('#stream').append(\n                                                        '<div class=\"no-video-container\">' +\n                                                        '<i class=\"fa fa-video-camera fa-5 no-video-icon\"></i>' +\n                                                        '<span class=\"no-video-text\">No remote video available</span>' +\n                                                        '</div>');\n                                                }\n                                            } else {\n                                                $('#stream .no-video-container').remove();\n                                                $('#remotevideo').removeClass('hide').show();\n                                            }\n                                            if (!addButtons)\n                                                return;\n                                            if (videoTracks && videoTracks.length &&\n                                                (Janus.webRTCAdapter.browserDetails.browser === \"chrome\" ||\n                                                    Janus.webRTCAdapter.browserDetails.browser === \"firefox\" ||\n                                                    Janus.webRTCAdapter.browserDetails.browser === \"safari\")) {\n                                                $('#curbitrate').removeClass('hide').show();\n                                                bitrateTimer = setInterval(function () {\n                                                    // Display updated bitrate, if supported\n                                                    var bitrate = streaming.getBitrate();\n                                                    $('#curbitrate').text(bitrate);\n                                                    // Check if the resolution changed too\n                                                    var width = $(\"#remotevideo\").get(0).videoWidth;\n                                                    var height = $(\"#remotevideo\").get(0).videoHeight;\n                                                    if (width > 0 && height > 0)\n                                                        $('#curres').removeClass('hide').text(width + 'x' + height).show();\n                                                }, 1000);\n                                            }\n                                        },\n                                        ondataopen: function (data) {\n                                            Janus.log(\"The DataChannel is available!\");\n                                            $('#waitingvideo').remove();\n                                            $('#stream').append(\n                                                '<input class=\"form-control\" type=\"text\" id=\"datarecv\" disabled></input>'\n                                            );\n                                            if (spinner)\n                                                spinner.stop();\n                                            spinner = null;\n                                        },\n                                        ondata: function (data) {\n                                            Janus.debug(\"We got data from the DataChannel!\", data);\n                                            $('#datarecv').val(data);\n                                        },\n                                        oncleanup: function () {\n                                            Janus.log(\" ::: Got a cleanup notification :::\");\n                                            $('#waitingvideo').remove();\n                                            $('#remotevideo').remove();\n                                            $('#datarecv').remove();\n                                            $('.no-video-container').remove();\n                                            $('#bitrate').attr('disabled', true);\n                                            $('#bitrateset').html('Bandwidth<span class=\"caret\"></span>');\n                                            $('#curbitrate').hide();\n                                            if (bitrateTimer)\n                                                clearInterval(bitrateTimer);\n                                            bitrateTimer = null;\n                                            $('#curres').hide();\n                                            $('#simulcast').remove();\n                                            $('#metadata').empty();\n                                            $('#info').addClass('hide').hide();\n                                            simulcastStarted = false;\n                                        }\n                                    });\n                            },\n                            error: function (error) {\n                                Janus.error(error);\n                                bootbox.alert(error, function () {\n                                    window.location.reload();\n                                });\n                            },\n                            destroyed: function () {\n                                window.location.reload();\n                            }\n                        });\n                });\n            }\n        });\n    });\n\n    async function updateStreamsList() {\n        Janus.debug(\"updateStreamsList\")\n\n        const myInit = {\n            method: 'GET'\n        }\n        // fetch api \n\n        //const id = '60c07f7c360386d21c4ba0eb'; // fetch id\n        const id = '60d44ebac53d31346858c759'\n        const device = await fetch(`http://localhost:5003/auth/users/${id}/device`, myInit)\n            .then(response => response.json())\n            .then(data => data.device);\n\n        Janus.log(\"fetched device \", device);\n\n        $('#update-streams').unbind('click').addClass('fa-spin');\n        var body = { request: \"list\" };\n        Janus.debug(\"Sending message:\", body);\n        streaming.send({\n            message: body, success: function (result) {\n                setTimeout(function () {\n                    $('#update-streams').removeClass('fa-spin').click(updateStreamsList);\n                }, 500);\n                if (!result) {\n                    bootbox.alert(\"Got no response to our query for available streams\");\n                    return;\n                }\n                if (result[\"list\"]) {\n                    $('#streams').removeClass('hide').show();\n                    $('#streamslist').empty();\n                    $('#watch').attr('disabled', true).unbind('click');\n                    var list = result[\"list\"];\n                    Janus.log(\"Got a list of available streams\");\n                    if (list && Array.isArray(list)) {\n                        list.sort(function (a, b) {\n                            if (!a || a.id < (b ? b.id : 0))\n                                return -1;\n                            if (!b || b.id < (a ? a.id : 0))\n                                return 1;\n                            return 0;\n                        });\n                    }\n                    Janus.debug(list);\n\n                    list = list.filter(stream => device.includes(stream.id + \"\"));\n\n                    Janus.log(\"filtered list : \", list);\n\n                    for (var mp in list) {\n                        Janus.debug(\"  >> [\" + list[mp][\"id\"] + \"] \" + list[mp][\"description\"] + \" (\" + list[mp][\"type\"] + \")\");\n                        $('#streamslist').append(\"<li><a href='#' id='\" + list[mp][\"id\"] + \"'>\" + list[mp][\"description\"] + \" (\" + list[mp][\"type\"] + \")\" + \"</a></li>\");\n                    }\n                    $('#streamslist a').unbind('click').click(function () {\n                        selectedStream = $(this).attr(\"id\");\n                        $('#streamset').html($(this).html()).parent().removeClass('open');\n                        return false;\n\n                    });\n                    $('#watch').removeAttr('disabled').unbind('click').click(startStream);\n                }\n            }\n        });\n    }\n\n    function getStreamInfo() {\n        $('#metadata').empty();\n        $('#info').addClass('hide').hide();\n        if (!selectedStream)\n            return;\n        // Send a request for more info on the mountpoint we subscribed to\n        var body = { request: \"info\", id: parseInt(selectedStream) || selectedStream };\n        streaming.send({\n            message: body, success: function (result) {\n                if (result && result.info && result.info.metadata) {\n                    $('#metadata').html(result.info.metadata);\n                    $('#info').removeClass('hide').show();\n                }\n            }\n        });\n    }\n\n    function startStream() {\n        Janus.log(\"Selected video id #\" + selectedStream);\n        if (!selectedStream) {\n            bootbox.alert(\"Select a stream from the list\");\n            return;\n        }\n        $('#streamset').attr('disabled', true);\n        $('#streamslist').attr('disabled', true);\n        $('#watch').attr('disabled', true).unbind('click');\n        var body = { request: \"watch\", id: parseInt(selectedStream) || selectedStream };\n        streaming.send({ message: body });\n        // No remote video yet\n        $('#stream').append('<video class=\"rounded centered\" id=\"waitingvideo\" width=\"100%\" height=\"100%\" />');\n        if (spinner == null) {\n            var target = document.getElementById('stream');\n            spinner = new Spinner({ top: 100 }).spin(target);\n        } else {\n            spinner.spin();\n        }\n        // Get some more info for the mountpoint to display, if any\n        getStreamInfo();\n    }\n\n    function stopStream() {\n        $('#watch').attr('disabled', true).unbind('click');\n        var body = { request: \"stop\" };\n        streaming.send({ message: body });\n        streaming.hangup();\n        $('#streamset').removeAttr('disabled');\n        $('#streamslist').removeAttr('disabled');\n        $('#watch').html(\"Watch or Listen\").removeAttr('disabled').unbind('click').click(startStream);\n        $('#status').empty().hide();\n        $('#bitrate').attr('disabled', true);\n        $('#bitrateset').html('Bandwidth<span class=\"caret\"></span>');\n        $('#curbitrate').hide();\n        if (bitrateTimer)\n            clearInterval(bitrateTimer);\n        bitrateTimer = null;\n        $('#curres').empty().hide();\n        $('#simulcast').remove();\n        simulcastStarted = false;\n    }\n\n    return (\n        <div class=\"container\">\n            <div class=\"row\">\n                <div class=\"col-md-12\">\n                    <div class=\"page-header\">\n                        <h1>Plugin Demo: Streaming\n                            <button class=\"btn btn-default\" autocomplete=\"off\" id=\"start\">Start</button>\n                        </h1>\n                    </div>\n                    <div class=\"container\" id=\"details\">\n                        <div class=\"row\">\n                            <div class=\"col-md-12\">\n                                <h3>Demo details</h3>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"container hide\" id=\"streams\">\n                        <div class=\"col-md-6\">\n                            <div class=\"row\">\n                                <div class=\"panel panel-default\">\n                                    <div class=\"panel-heading\">\n                                        <h3 class=\"panel-title\">Streams <i id=\"update-streams\" class=\"fa fa-refresh\"\n                                            title=\"Update list of streams\" style=\"cursor: pointer;\"></i></h3>\n                                    </div>\n                                    <div class=\"panel-body\" id=\"list\">\n                                        <div class=\"btn-group btn-group-sm\">\n                                            <button class=\"btn btn-primary\" autocomplete=\"off\" id=\"watch\">Watch or\n                                                Listen</button>\n                                            <div class=\"btn-group btn-group-sm\">\n                                                <button autocomplete=\"off\" id=\"streamset\"\n                                                    class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\">\n                                                    Streams list<span class=\"caret\"></span>\n                                                </button>\n                                                <ul id=\"streamslist\" class=\"dropdown-menu\" role=\"menu\">\n                                                </ul>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"row hide\" id=\"info\">\n                                <div class=\"panel panel-default\">\n                                    <div class=\"panel-heading\">\n                                        <h3 class=\"panel-title\"><i class=\"fa fa-info-circle\"></i> Metadata</h3>\n                                    </div>\n                                    <div class=\"panel-body\">\n                                        <pre id=\"metadata\" style=\"word-break: break-word;\"></pre>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"col-md-6\">\n                            <div class=\"panel panel-default\">\n                                <div class=\"panel-heading\">\n                                    <h3 class=\"panel-title\">Stream\n                                        <span class=\"label label-info hide\" id=\"status\"></span>\n                                        <span class=\"label label-primary hide\" id=\"curres\"></span>\n                                        <span class=\"label label-info hide\" id=\"curbitrate\"></span>\n                                    </h3>\n                                </div>\n                                <div class=\"panel-body\" id=\"stream\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    );\n}\nexport default Stream;"]},"metadata":{},"sourceType":"module"}