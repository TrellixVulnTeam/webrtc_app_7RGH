{"ast":null,"code":"import _regeneratorRuntime from\"/home/abu/Documents/dev/experiments/exp1/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/abu/Documents/dev/experiments/exp1/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/abu/Documents/dev/experiments/exp1/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import Axios from\"axios\";import React,{useContext,useState}from\"react\";import{Link,useHistory}from\"react-router-dom\";import UserContext from\"../../context/UserContext\";import domain from\"../../util/domain\";import ErrorMessage from\"../misc/ErrorMessage\";import\"./AuthForm.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),formEmail=_useState2[0],setFormEmail=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),formPassword=_useState4[0],setFormPassword=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),errorMessage=_useState6[0],setErrorMessage=_useState6[1];var _useContext=useContext(UserContext),getUser=_useContext.getUser;var history=useHistory();function login(_x){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var loginData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();loginData={email:formEmail,password:formPassword};_context.prev=2;_context.next=5;return Axios.post(\"\".concat(domain,\"/auth/login\"),loginData);case 5:_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](2);if(_context.t0.response){if(_context.t0.response.data.errorMessage){setErrorMessage(_context.t0.response.data.errorMessage);}}return _context.abrupt(\"return\");case 11:_context.next=13;return getUser();case 13:history.push(\"/\");case 14:case\"end\":return _context.stop();}}},_callee,null,[[2,7]]);}));return _login.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"auth-form\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Log in\"}),errorMessage&&/*#__PURE__*/_jsx(ErrorMessage,{message:errorMessage,clear:function clear(){return setErrorMessage(null);}}),/*#__PURE__*/_jsxs(\"form\",{className:\"form\",onSubmit:login,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"form-email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{id:\"form-email\",type:\"email\",value:formEmail,onChange:function onChange(e){return setFormEmail(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"form-password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{id:\"form-password\",type:\"password\",value:formPassword,onChange:function onChange(e){return setFormPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-submit\",type:\"submit\",children:\"Log in\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Don't have an account yet? \",/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"Register here.\"})]})]});}export default Login;","map":{"version":3,"sources":["/home/abu/Documents/dev/experiments/exp1/client/src/components/auth/Login.js"],"names":["Axios","React","useContext","useState","Link","useHistory","UserContext","domain","ErrorMessage","Login","formEmail","setFormEmail","formPassword","setFormPassword","errorMessage","setErrorMessage","getUser","history","login","e","preventDefault","loginData","email","password","post","response","data","push","target","value"],"mappings":"mYAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,UAAhB,CAA4BC,QAA5B,KAA4C,OAA5C,CACA,OAASC,IAAT,CAAeC,UAAf,KAAiC,kBAAjC,CACA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,MAAOC,CAAAA,YAAP,KAAyB,sBAAzB,CACA,MAAO,iBAAP,C,wFAEA,QAASC,CAAAA,KAAT,EAAiB,CACf,cAAkCN,QAAQ,CAAC,EAAD,CAA1C,wCAAOO,SAAP,eAAkBC,YAAlB,eACA,eAAwCR,QAAQ,CAAC,EAAD,CAAhD,yCAAOS,YAAP,eAAqBC,eAArB,eACA,eAAwCV,QAAQ,CAAC,IAAD,CAAhD,yCAAOW,YAAP,eAAqBC,eAArB,eAEA,gBAAoBb,UAAU,CAACI,WAAD,CAA9B,CAAQU,OAAR,aAAQA,OAAR,CAEA,GAAMC,CAAAA,OAAO,CAAGZ,UAAU,EAA1B,CAPe,QASAa,CAAAA,KATA,2HASf,iBAAqBC,CAArB,gIACEA,CAAC,CAACC,cAAF,GAEMC,SAHR,CAGoB,CAChBC,KAAK,CAAEZ,SADS,CAEhBa,QAAQ,CAAEX,YAFM,CAHpB,uCASUZ,CAAAA,KAAK,CAACwB,IAAN,WAAcjB,MAAd,gBAAmCc,SAAnC,CATV,uFAWI,GAAI,YAAII,QAAR,CAAkB,CAChB,GAAI,YAAIA,QAAJ,CAAaC,IAAb,CAAkBZ,YAAtB,CAAoC,CAClCC,eAAe,CAAC,YAAIU,QAAJ,CAAaC,IAAb,CAAkBZ,YAAnB,CAAf,CACD,CACF,CAfL,gEAmBQE,CAAAA,OAAO,EAnBf,SAoBEC,OAAO,CAACU,IAAR,CAAa,GAAb,EApBF,oEATe,wCAgCf,mBACE,aAAK,SAAS,CAAC,WAAf,wBACE,8BADF,CAEGb,YAAY,eACX,KAAC,YAAD,EACE,OAAO,CAAEA,YADX,CAEE,KAAK,CAAE,uBAAMC,CAAAA,eAAe,CAAC,IAAD,CAArB,EAFT,EAHJ,cAQE,cAAM,SAAS,CAAC,MAAhB,CAAuB,QAAQ,CAAEG,KAAjC,wBACE,cAAO,OAAO,CAAC,YAAf,mBADF,cAEE,cACE,EAAE,CAAC,YADL,CAEE,IAAI,CAAC,OAFP,CAGE,KAAK,CAAER,SAHT,CAIE,QAAQ,CAAE,kBAACS,CAAD,QAAOR,CAAAA,YAAY,CAACQ,CAAC,CAACS,MAAF,CAASC,KAAV,CAAnB,EAJZ,EAFF,cASE,cAAO,OAAO,CAAC,eAAf,sBATF,cAUE,cACE,EAAE,CAAC,eADL,CAEE,IAAI,CAAC,UAFP,CAGE,KAAK,CAAEjB,YAHT,CAIE,QAAQ,CAAE,kBAACO,CAAD,QAAON,CAAAA,eAAe,CAACM,CAAC,CAACS,MAAF,CAASC,KAAV,CAAtB,EAJZ,EAVF,cAiBE,eAAQ,SAAS,CAAC,YAAlB,CAA+B,IAAI,CAAC,QAApC,oBAjBF,GARF,cA6BE,gEAC6B,KAAC,IAAD,EAAM,EAAE,CAAC,WAAT,4BAD7B,GA7BF,GADF,CAmCD,CAED,cAAepB,CAAAA,KAAf","sourcesContent":["import Axios from \"axios\";\nimport React, { useContext, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport UserContext from \"../../context/UserContext\";\nimport domain from \"../../util/domain\";\nimport ErrorMessage from \"../misc/ErrorMessage\";\nimport \"./AuthForm.scss\";\n\nfunction Login() {\n  const [formEmail, setFormEmail] = useState(\"\");\n  const [formPassword, setFormPassword] = useState(\"\");\n  const [errorMessage, setErrorMessage] = useState(null);\n\n  const { getUser } = useContext(UserContext);\n\n  const history = useHistory();\n\n  async function login(e) {\n    e.preventDefault();\n\n    const loginData = {\n      email: formEmail,\n      password: formPassword,\n    };\n\n    try {\n      await Axios.post(`${domain}/auth/login`, loginData);\n    } catch (err) {\n      if (err.response) {\n        if (err.response.data.errorMessage) {\n          setErrorMessage(err.response.data.errorMessage);\n        }\n      }\n      return;\n    }\n\n    await getUser();\n    history.push(\"/\");\n  }\n\n  return (\n    <div className=\"auth-form\">\n      <h2>Log in</h2>\n      {errorMessage && (\n        <ErrorMessage\n          message={errorMessage}\n          clear={() => setErrorMessage(null)}\n        />\n      )}\n      <form className=\"form\" onSubmit={login}>\n        <label htmlFor=\"form-email\">Email</label>\n        <input\n          id=\"form-email\"\n          type=\"email\"\n          value={formEmail}\n          onChange={(e) => setFormEmail(e.target.value)}\n        />\n\n        <label htmlFor=\"form-password\">Password</label>\n        <input\n          id=\"form-password\"\n          type=\"password\"\n          value={formPassword}\n          onChange={(e) => setFormPassword(e.target.value)}\n        />\n\n        <button className=\"btn-submit\" type=\"submit\">\n          Log in\n        </button>\n      </form>\n      <p>\n        Don't have an account yet? <Link to=\"/register\">Register here.</Link>\n      </p>\n    </div>\n  );\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}